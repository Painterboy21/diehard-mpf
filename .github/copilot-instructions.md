## Purpose

This file contains short, actionable guidance to help AI coding agents be immediately productive in this repository. Focus on small, precise edits and follow the project's conventions (Godot 4 + MPF integration).

## Quick summary / big picture

- This is a Godot project (`project.godot`) configured for Godot 4.x (project lists feature "4.4").
- The repo embeds a Mission Pinball Framework integration under `addons/mpf-gmc/`. The MPF runtime is autoloaded via `project.godot` (`MPF="*res://addons/mpf-gmc/mpf_gmc.gd").
- Visual/lighting sequences are YAML shows under `shows/` (e.g. `shows/attract_christmas.yaml`) and device mappings live in `config/*.yaml`.
- Assets live under `godot-media/` and `images/`; UI scenes and slides are in `slides/`.

## Key files & locations (examples)

- `project.godot` — Godot engine version / autoloads. Look here first to understand runtime entry points.
- `addons/mpf-gmc/` — MPF Godot connector and editor plugin (see `plugin.cfg`, `mpf_gmc.gd`, and `classes/` directory).
- `shows/*.yaml` — Frame-based lighting/video sequences. Example frame entries use `duration: 0.03333s` and `lights: { l29: ff3333%100 }`.
- `config/*.yaml` — Machine device definitions (coils, switches, lights, shots). These drive how shows and modes map to physical/e virtual devices.
- `slides/` and `modes/` — Godot scenes and MPF mode configurations; edit carefully to preserve UIDs.

## Conventions & patterns

- Godot autoloads: MPF is an autoload singleton. Treat `addons/mpf-gmc/mpf_gmc.gd` as the main bridge between MPF YAML and Godot scenes.
- Shows format: each entry is a frame with a `duration` (seconds) and `lights` mapping. Color/intensity format is hex plus percent (example: `ff3333%100`). Maintain the same numeric IDs (e.g. `l29`, `f131`) — these map to `config/*.yaml` device IDs.
- GDScript structure: core helpers live in `addons/mpf-gmc/classes/` (e.g. `mpf_display.gd`, `mpf_event_handler.gd`, `mpf_sound.gd`). When adding features, prefer adding small, well-scoped methods to these classes rather than global edits.
- Do not reassign UIDs used by Godot resources; Godot's `uid://` references appear in `project.godot` and individual `.tscn` files — changing them may break autoload/main scene links.

## Developer workflows (what works here)

- Run locally: open the folder in Godot 4.4 and press Play (use main scene in `project.godot`), or run from the CLI from the repo root with your Godot 4.x binary:

  `godot --path "c:\Users\finis\diehard-mpf"`

- Edit shows: update YAML files in `shows/`. Keep the formatting: list of frames with `duration:` and `lights:`; use consistent hex+% intensity tokens.
- Debug logs: check the `logs/` directory for runtime traces generated by the project.

## Integration points & external dependencies

- MPF integration is bundled inside `addons/mpf-gmc/` (no external package manager required). The plugin describes itself as "A Media Controller for the Mission Pinball Framework (MPF)" in `plugin.cfg`.
- Device definitions and runtime mapping happen via `config/*.yaml`. Any change to device IDs or naming requires coordinated updates in shows and code that references those IDs.

## Typical small tasks an agent can do safely

- Fix typos or small logic bugs inside `addons/mpf-gmc/classes/*.gd` when changes are limited to a single class.
- Add or update a frame in a `shows/*.yaml` file (preserve list structure and duration formatting).
- Update `plugin.cfg` metadata or bump the plugin `version` (keep format consistent).

## Avoid / be cautious about

- Don't change Godot UIDs or wholesale reparenting of scenes without human review.
- Don't rename device IDs in `config/*.yaml` without updating all `shows/*.yaml` and any code that references them.

## Where to look for more context

- To understand runtime behavior: `addons/mpf-gmc/mpf_gmc.gd` and `addons/mpf-gmc/classes/*.gd`.
- To understand visual sequences: `shows/*.yaml` (example: `shows/attract_christmas.yaml`).
- To inspect machine wiring / device naming: `config/*.yaml` (coils, switches, lights).

If anything above is unclear or you want more examples (e.g., a small refactor of an MPF class or an explanation of a specific `shows/` frame), tell me which file and I'll expand or iterate.
